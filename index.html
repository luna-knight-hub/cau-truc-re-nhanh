<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>B√†i 10: C·∫•u tr√∫c r·∫Ω nh√°nh - Tin h·ªçc 5 (CTST)</title>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;600;700;800&display=swap" rel="stylesheet">

    <!-- Chosen Palette: Warm Neutrals & Scratch Orange -->
    <!-- Application Structure Plan: 
         1. Dashboard/Overview: High-level lesson goals and Digital Competency visualization (Radar Chart).
         2. Interactive Theory (Ti·∫øt 1): Explains "If-Then" vs "If-Then-Else" using an interactive Logic Flow Simulator (Clickable decisions).
         3. Virtual Exercise Sheet: A gamified version of the provided "Phieu_Bai_Tap" with instant feedback.
         4. Practice Lab (Ti·∫øt 2): A Canvas-based simulation of the "Cat & Mouse" Scratch project, allowing students to "run code" and see logic in action.
         Rationale: This structure moves from abstract goals to concrete concepts, then assessment, and finally application, mirroring the pedagogical flow of the lesson plan.
    -->

    <style>
        body {
            font-family: 'Nunito', sans-serif;
            background-color: #fdfaf6; /* Warm neutral background */
            color: #333;
        }
        
        /* Chart Container Styling - Mandatory Requirements */
        .chart-wrapper {
            position: relative;
            width: 100%;
            max-width: 600px; /* Constrain width */
            margin-left: auto;
            margin-right: auto; /* Center horizontally */
            height: 350px; /* Base height */
            max-height: 400px; /* Max height limit */
        }

        /* Custom Scratch Block Styling */
        .scratch-block {
            position: relative;
            background-color: #FFAB19; /* Scratch Control Orange */
            color: white;
            padding: 8px 12px;
            border-radius: 8px;
            font-weight: 700;
            box-shadow: 0 2px 0 #cf8b17;
            display: inline-flex;
            align-items: center;
            cursor: default;
            font-size: 0.9rem;
        }
        
        .scratch-block::before {
            content: '';
            position: absolute;
            top: 0;
            left: 12px;
            width: 15px;
            height: 4px;
            background-color: rgba(0,0,0,0.1);
            border-bottom-left-radius: 4px;
            border-bottom-right-radius: 4px;
        }
        
        .scratch-block::after {
            content: '';
            position: absolute;
            bottom: -4px;
            left: 12px;
            width: 15px;
            height: 4px;
            background-color: #FFAB19;
            border-bottom-left-radius: 4px;
            border-bottom-right-radius: 4px;
            z-index: 10;
        }

        .scratch-hex {
            background-color: #4CBFE6; /* Sensing Blue */
            padding: 4px 8px;
            border-radius: 16px;
            margin: 0 4px;
            font-size: 0.8rem;
            box-shadow: inset 0 1px 2px rgba(0,0,0,0.2);
        }

        .scratch-c-mouth {
            min-height: 20px;
            border-left: 12px solid #FFAB19;
            border-top: 4px solid #FFAB19;
            border-bottom: 4px solid #FFAB19;
            background-color: rgba(255, 171, 25, 0.1);
            margin: 4px 0 4px 10px;
            border-radius: 0 4px 4px 0;
        }

        /* Interactive Flowchart Nodes */
        .flow-node {
            transition: all 0.3s ease;
        }
        .flow-node.active {
            transform: scale(1.05);
            box-shadow: 0 0 15px rgba(255, 171, 25, 0.5);
            border-color: #FFAB19;
        }

        /* Navigation Active State */
        .nav-btn.active {
            background-color: #FFAB19;
            color: white;
            box-shadow: 0 4px 6px -1px rgba(255, 171, 25, 0.3);
        }

        /* Hide Scrollbar for clean UI */
        .no-scrollbar::-webkit-scrollbar {
            display: none;
        }
        .no-scrollbar {
            -ms-overflow-style: none;
            scrollbar-width: none;
        }
    </style>
    <!-- CONFIRMATION: NO SVG graphics used. NO Mermaid JS used. -->
    <!-- Visualization & Content Choices:
         1. Competency Radar Chart: Visualizes the focus on Programming (3.4) and Problem Solving (5.1) from the lesson plan.
         2. Logic Flow Simulator: Replaces static diagrams. User clicks a "Condition" button, JS logic routes the path visibly. Goal: Teach Branching logic.
         3. Canvas Game: Replaces static Scratch screenshots. A live, runnable simulation of the "Cat & Mouse" game described in Lesson 2. Goal: Demonstrate the result of the code.
         4. Interactive Exercise: Replaces paper sheet. Drag-and-match or Click-to-select. Goal: Immediate assessment.
    -->
</head>
<body class="min-h-screen flex flex-col">

    <!-- Header -->
    <header class="bg-white shadow-sm sticky top-0 z-50">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 h-16 flex items-center justify-between">
            <div class="flex items-center gap-3">
                <div class="w-10 h-10 bg-orange-500 rounded-lg flex items-center justify-center text-white font-bold text-xl">10</div>
                <div>
                    <h1 class="text-lg font-bold text-gray-800 leading-tight">C·∫•u tr√∫c R·∫Ω nh√°nh</h1>
                    <p class="text-xs text-gray-500">Tin h·ªçc L·ªõp 5 - Ch√¢n tr·ªùi s√°ng t·∫°o</p>
                </div>
            </div>
            <div class="hidden md:flex items-center gap-2">
                <span class="px-3 py-1 bg-blue-100 text-blue-700 rounded-full text-xs font-semibold">Ti·∫øt 1: L√Ω thuy·∫øt</span>
                <span class="px-3 py-1 bg-green-100 text-green-700 rounded-full text-xs font-semibold">Ti·∫øt 2: Th·ª±c h√†nh</span>
            </div>
        </div>
    </header>

    <!-- Main Navigation -->
    <nav class="bg-white border-b border-gray-100">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex space-x-4 overflow-x-auto no-scrollbar py-3">
                <button onclick="switchTab('overview')" id="btn-overview" class="nav-btn active px-4 py-2 rounded-lg text-sm font-medium text-gray-600 hover:bg-orange-50 transition-colors whitespace-nowrap">T·ªïng quan & M·ª•c ti√™u</button>
                <button onclick="switchTab('theory')" id="btn-theory" class="nav-btn px-4 py-2 rounded-lg text-sm font-medium text-gray-600 hover:bg-orange-50 transition-colors whitespace-nowrap">Ti·∫øt 1: M√¥ ph·ªèng L√Ω thuy·∫øt</button>
                <button onclick="switchTab('exercise')" id="btn-exercise" class="nav-btn px-4 py-2 rounded-lg text-sm font-medium text-gray-600 hover:bg-orange-50 transition-colors whitespace-nowrap">Phi·∫øu B√†i T·∫≠p</button>
                <button onclick="switchTab('practice')" id="btn-practice" class="nav-btn px-4 py-2 rounded-lg text-sm font-medium text-gray-600 hover:bg-orange-50 transition-colors whitespace-nowrap">Ti·∫øt 2: Ph√≤ng Lab ·∫¢o</button>
            </div>
        </div>
    </nav>

    <!-- Content Area -->
    <main class="flex-grow max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8 w-full">

        <!-- SECTION: OVERVIEW -->
        <section id="section-overview" class="space-y-8 animate-fade-in">
            <div class="bg-white rounded-2xl p-6 shadow-sm border border-gray-100">
                <h2 class="text-2xl font-bold text-gray-800 mb-4">M·ª•c ti√™u B√†i h·ªçc</h2>
                <p class="text-gray-600 mb-6">
                    Trong b√†i h·ªçc n√†y, ch√∫ng ta s·∫Ω t√¨m hi·ªÉu v·ªÅ c√°ch m√°y t√≠nh ƒë∆∞a ra quy·∫øt ƒë·ªãnh. Gi·ªëng nh∆∞ vi·ªác em quy·∫øt ƒë·ªãnh mang √¥ khi tr·ªùi m∆∞a, m√°y t√≠nh c≈©ng c·∫ßn c√°c c·∫•u tr√∫c 
                    <span class="font-bold text-orange-500">N·∫øu... Th√¨...</span> ƒë·ªÉ ho·∫°t ƒë·ªông th√¥ng minh h∆°n.
                </p>
                
                <div class="grid grid-cols-1 md:grid-cols-2 gap-8 items-center">
                    <div class="space-y-4">
                        <div class="flex items-start gap-4">
                            <div class="p-3 bg-orange-100 rounded-xl text-orange-600 text-2xl">‚ö°</div>
                            <div>
                                <h3 class="font-bold text-gray-800">Ki·∫øn th·ª©c Tr·ªçng t√¢m</h3>
                                <ul class="text-sm text-gray-600 list-disc list-inside mt-1 space-y-1">
                                    <li>Nh·∫≠n bi·∫øt t√¨nh hu·ªëng r·∫Ω nh√°nh trong ƒë·ªùi s·ªëng.</li>
                                    <li>Ph√¢n bi·ªát d·∫°ng <strong>Thi·∫øu</strong> v√† d·∫°ng <strong>ƒê·ªß</strong>.</li>
                                    <li>S·ª≠ d·ª•ng kh·ªëi l·ªánh Control trong Scratch.</li>
                                </ul>
                            </div>
                        </div>
                        <div class="flex items-start gap-4">
                            <div class="p-3 bg-blue-100 rounded-xl text-blue-600 text-2xl">üéØ</div>
                            <div>
                                <h3 class="font-bold text-gray-800">Y√™u c·∫ßu c·∫ßn ƒë·∫°t</h3>
                                <p class="text-sm text-gray-600 mt-1">
                                    H·ªçc sinh gi·∫£i th√≠ch ƒë∆∞·ª£c k·ªãch b·∫£n ƒë∆°n gi·∫£n v√† t·ª± t·∫°o ƒë∆∞·ª£c ch∆∞∆°ng tr√¨nh c√≥ ƒëi·ªÅu ki·ªán ki·ªÉm tra.
                                </p>
                            </div>
                        </div>
                    </div>

                    <!-- Competency Chart -->
                    <div class="bg-gray-50 rounded-xl p-4">
                        <h4 class="text-center text-sm font-bold text-gray-500 mb-2">Bi·ªÉu ƒë·ªì NƒÉng l·ª±c S·ªë (TT 02/2025)</h4>
                        <div class="chart-wrapper">
                            <canvas id="competencyChart"></canvas>
                        </div>
                        <div class="text-center mt-2 text-xs text-gray-400">
                            T·∫≠p trung m·∫°nh v√†o L·∫≠p tr√¨nh (3.4) v√† Gi·∫£i quy·∫øt v·∫•n ƒë·ªÅ (5.1)
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- SECTION: THEORY (INTERACTIVE SIMULATION) -->
        <section id="section-theory" class="hidden space-y-8">
            <div class="bg-white rounded-2xl p-6 shadow-sm border border-gray-100">
                <h2 class="text-2xl font-bold text-gray-800 mb-2">Kh√°m ph√°: M√°y t√≠nh suy nghƒ© nh∆∞ th·∫ø n√†o?</h2>
                <p class="text-gray-600 mb-6">H√£y t∆∞∆°ng t√°c v·ªõi c√°c t√¨nh hu·ªëng d∆∞·ªõi ƒë√¢y ƒë·ªÉ hi·ªÉu s·ª± kh√°c bi·ªát gi·ªØa hai d·∫°ng r·∫Ω nh√°nh.</p>

                <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
                    
                    <!-- D·∫°ng Thi·∫øu -->
                    <div class="border-2 border-dashed border-gray-200 rounded-2xl p-6 hover:border-orange-300 transition-colors">
                        <div class="flex items-center justify-between mb-4">
                            <h3 class="text-xl font-bold text-gray-700">1. D·∫°ng Thi·∫øu (If... Then)</h3>
                            <span class="bg-orange-100 text-orange-600 px-3 py-1 rounded-full text-xs font-bold">Ch·ªâ l√†m khi ƒê√∫ng</span>
                        </div>
                        
                        <div class="bg-gray-50 p-4 rounded-xl mb-4">
                            <p class="text-center font-medium text-gray-600 mb-2">T√¨nh hu·ªëng: "N·∫øu tr·ªùi m∆∞a th√¨ mang √¥"</p>
                            <div class="flex justify-center gap-4">
                                <button onclick="simulateBranch('missing', true)" class="px-4 py-2 bg-blue-500 text-white rounded-lg shadow hover:bg-blue-600 transition">üåßÔ∏è Tr·ªùi M∆∞a</button>
                                <button onclick="simulateBranch('missing', false)" class="px-4 py-2 bg-yellow-500 text-white rounded-lg shadow hover:bg-yellow-600 transition">‚òÄÔ∏è Tr·ªùi N·∫Øng</button>
                            </div>
                        </div>

                        <!-- Visualization Flow -->
                        <div class="flex flex-col items-center gap-2 text-sm">
                            <div id="m-step1" class="flow-node w-32 py-2 bg-gray-200 rounded text-center border-2 border-transparent">Ki·ªÉm tra th·ªùi ti·∫øt</div>
                            <div class="h-6 w-0.5 bg-gray-300"></div>
                            
                            <!-- Diamond Decision -->
                            <div id="m-decision" class="flow-node w-24 h-24 bg-white border-2 border-gray-300 flex items-center justify-center text-center transform rotate-45 mb-2 relative">
                                <span class="transform -rotate-45 font-bold text-xs">C√≥ m∆∞a kh√¥ng?</span>
                                <!-- Path lines handled by absolute positioning visually simpler for HTML -->
                            </div>
                            
                            <div class="flex w-full justify-center gap-8 relative">
                                <!-- True Path -->
                                <div class="flex flex-col items-center">
                                    <div class="text-green-600 text-xs font-bold mb-1">ƒê√öNG</div>
                                    <div class="h-6 w-0.5 bg-green-500"></div>
                                    <div id="m-action" class="flow-node w-32 py-2 bg-white border-2 border-gray-200 rounded text-center text-gray-400">Mang √î ‚òÇÔ∏è</div>
                                </div>
                                <!-- False Path (Empty) -->
                                <div class="flex flex-col items-center relative">
                                    <div class="text-red-500 text-xs font-bold mb-1 absolute -top-8 -right-8">SAI (Kh√¥ng l√†m g√¨)</div>
                                </div>
                            </div>
                            
                            <div class="h-6 w-0.5 bg-gray-300 mt-2"></div>
                            <div id="m-end" class="flow-node w-32 py-2 bg-gray-800 text-white rounded-full text-center">K·∫øt th√∫c</div>
                        </div>
                        <p id="m-feedback" class="text-center mt-4 h-6 font-bold text-orange-600"></p>
                    </div>

                    <!-- D·∫°ng ƒê·ªß -->
                    <div class="border-2 border-dashed border-gray-200 rounded-2xl p-6 hover:border-blue-300 transition-colors">
                        <div class="flex items-center justify-between mb-4">
                            <h3 class="text-xl font-bold text-gray-700">2. D·∫°ng ƒê·ªß (If... Then... Else)</h3>
                            <span class="bg-blue-100 text-blue-600 px-3 py-1 rounded-full text-xs font-bold">L√†m A ho·∫∑c B</span>
                        </div>

                        <div class="bg-gray-50 p-4 rounded-xl mb-4">
                            <p class="text-center font-medium text-gray-600 mb-2">T√¨nh hu·ªëng: "N·∫øu ƒë√∫ng th√¨ c·ªông ƒëi·ªÉm, sai th√¨ tr·ª´ ƒëi·ªÉm"</p>
                            <div class="flex justify-center gap-4">
                                <button onclick="simulateBranch('full', true)" class="px-4 py-2 bg-green-500 text-white rounded-lg shadow hover:bg-green-600 transition">‚úÖ Tr·∫£ l·ªùi ƒê√∫ng</button>
                                <button onclick="simulateBranch('full', false)" class="px-4 py-2 bg-red-500 text-white rounded-lg shadow hover:bg-red-600 transition">‚ùå Tr·∫£ l·ªùi Sai</button>
                            </div>
                        </div>

                        <!-- Visualization Flow -->
                        <div class="flex flex-col items-center gap-2 text-sm">
                            <div id="f-step1" class="flow-node w-32 py-2 bg-gray-200 rounded text-center border-2 border-transparent">Ki·ªÉm tra ƒë√°p √°n</div>
                            <div class="h-6 w-0.5 bg-gray-300"></div>
                            
                            <!-- Diamond Decision -->
                            <div id="f-decision" class="flow-node w-24 h-24 bg-white border-2 border-gray-300 flex items-center justify-center text-center transform rotate-45 mb-2">
                                <span class="transform -rotate-45 font-bold text-xs">ƒê√∫ng kh√¥ng?</span>
                            </div>
                            
                            <div class="flex w-full justify-between px-4 relative">
                                <!-- True Path -->
                                <div class="flex flex-col items-center w-1/2">
                                    <div class="text-green-600 text-xs font-bold mb-1">ƒê√öNG</div>
                                    <div class="h-6 w-0.5 bg-green-500"></div>
                                    <div id="f-action-true" class="flow-node w-28 py-2 bg-white border-2 border-gray-200 rounded text-center text-gray-400">C·ªông 10 ƒëi·ªÉm üìà</div>
                                </div>
                                <!-- False Path -->
                                <div class="flex flex-col items-center w-1/2">
                                    <div class="text-red-500 text-xs font-bold mb-1">SAI</div>
                                    <div class="h-6 w-0.5 bg-red-500"></div>
                                    <div id="f-action-false" class="flow-node w-28 py-2 bg-white border-2 border-gray-200 rounded text-center text-gray-400">Tr·ª´ 5 ƒëi·ªÉm üìâ</div>
                                </div>
                            </div>
                            
                            <div class="flex w-full justify-center mt-2">
                                <div class="h-6 w-0.5 bg-gray-300"></div>
                            </div>
                            <div id="f-end" class="flow-node w-32 py-2 bg-gray-800 text-white rounded-full text-center">K·∫øt th√∫c</div>
                        </div>
                         <p id="f-feedback" class="text-center mt-4 h-6 font-bold text-blue-600"></p>
                    </div>
                </div>
            </div>
        </section>

        <!-- SECTION: EXERCISE SHEET -->
        <section id="section-exercise" class="hidden space-y-6">
            <div class="bg-white rounded-2xl p-8 shadow-sm border border-gray-100 max-w-4xl mx-auto">
                <div class="border-b border-gray-200 pb-4 mb-6 flex justify-between items-end">
                    <div>
                        <h2 class="text-2xl font-bold text-gray-800">Phi·∫øu B√†i T·∫≠p: C·∫•u tr√∫c R·∫Ω nh√°nh</h2>
                        <p class="text-sm text-gray-500">Ho√†n th√†nh c√°c c√¢u h·ªèi d∆∞·ªõi ƒë√¢y ƒë·ªÉ ki·ªÉm tra ki·∫øn th·ª©c c·ªßa em.</p>
                    </div>
                    <div class="text-right">
                        <span id="score-display" class="text-3xl font-bold text-orange-500">0/100</span>
                        <span class="text-xs text-gray-400 block">ƒêi·ªÉm s·ªë</span>
                    </div>
                </div>

                <!-- Q1: Matching -->
                <div class="mb-8">
                    <h3 class="font-bold text-lg text-gray-800 mb-4">C√¢u 1: N·ªëi t√¨nh hu·ªëng (Click ch·ªçn c·∫∑p)</h3>
                    <div class="grid grid-cols-2 gap-8">
                        <div class="space-y-3" id="match-col-a">
                            <button onclick="selectMatch('A', 1)" id="match-A1" class="w-full text-left p-3 border rounded-lg hover:bg-gray-50 transition text-sm">1. N·∫øu nh·∫•n Space th√¨ nh·∫£y</button>
                            <button onclick="selectMatch('A', 2)" id="match-A2" class="w-full text-left p-3 border rounded-lg hover:bg-gray-50 transition text-sm">2. N·∫øu ƒëi·ªÉm > 5 ƒë·∫≠u, ng∆∞·ª£c l·∫°i tr∆∞·ª£t</button>
                            <button onclick="selectMatch('A', 3)" id="match-A3" class="w-full text-left p-3 border rounded-lg hover:bg-gray-50 transition text-sm">3. N·∫øu ch·∫°m c·∫°nh th√¨ b·∫≠t l·∫°i</button>
                            <button onclick="selectMatch('A', 4)" id="match-A4" class="w-full text-left p-3 border rounded-lg hover:bg-gray-50 transition text-sm">4. ƒê√∫ng c·ªông ƒëi·ªÉm, Sai tr·ª´ ƒëi·ªÉm</button>
                        </div>
                        <div class="space-y-3" id="match-col-b">
                            <button onclick="selectMatch('B', 1)" id="match-B1" class="w-full text-left p-3 border rounded-lg hover:bg-gray-50 transition text-sm font-bold text-orange-600">A. D·∫°ng Thi·∫øu (If... Then)</button>
                            <button onclick="selectMatch('B', 2)" id="match-B2" class="w-full text-left p-3 border rounded-lg hover:bg-gray-50 transition text-sm font-bold text-blue-600">B. D·∫°ng ƒê·ªß (If... Else)</button>
                        </div>
                    </div>
                    <p id="match-feedback" class="text-sm mt-2 font-bold min-h-[20px]"></p>
                </div>

                <!-- Q3: Block ID -->
                <div class="mb-8">
                    <h3 class="font-bold text-lg text-gray-800 mb-4">C√¢u 2: Nh·∫≠n di·ªán Kh·ªëi l·ªánh</h3>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <div class="bg-gray-50 p-4 rounded-xl flex flex-col items-center">
                            <div class="scratch-block mb-4">
                                n·∫øu <span class="scratch-hex"> ? </span> th√¨
                            </div>
                            <div class="scratch-c-mouth w-full"></div>
                            <select id="q2-select1" onchange="checkQ2()" class="mt-4 p-2 border rounded text-sm w-full">
                                <option value="">-- Ch·ªçn t√™n g·ªçi --</option>
                                <option value="correct">N·∫øu... Th√¨ (D·∫°ng thi·∫øu)</option>
                                <option value="wrong">N·∫øu... Th√¨... Kh√¥ng th√¨ (D·∫°ng ƒë·ªß)</option>
                            </select>
                        </div>
                        <div class="bg-gray-50 p-4 rounded-xl flex flex-col items-center">
                            <div class="scratch-block mb-2">
                                n·∫øu <span class="scratch-hex"> ? </span> th√¨
                            </div>
                            <div class="scratch-c-mouth w-full mb-2"></div>
                            <div class="scratch-block w-full" style="background: orange; box-shadow: none; color: white; padding:0;">kh√¥ng th√¨</div>
                            <div class="scratch-c-mouth w-full"></div>
                            
                            <select id="q2-select2" onchange="checkQ2()" class="mt-4 p-2 border rounded text-sm w-full">
                                <option value="">-- Ch·ªçn t√™n g·ªçi --</option>
                                <option value="wrong">N·∫øu... Th√¨ (D·∫°ng thi·∫øu)</option>
                                <option value="correct">N·∫øu... Th√¨... Kh√¥ng th√¨ (D·∫°ng ƒë·ªß)</option>
                            </select>
                        </div>
                    </div>
                </div>

                <!-- Q5: Logic Writing -->
                <div class="mb-8">
                    <h3 class="font-bold text-lg text-gray-800 mb-4">C√¢u 3: T∆∞ duy L·∫≠p tr√¨nh</h3>
                    <p class="text-gray-600 italic mb-4">"M·∫π d·∫∑n: N·∫øu con l√†m xong b√†i t·∫≠p s·ªõm th√¨ m·∫π cho ƒëi xem phim, c√≤n kh√¥ng l√†m xong th√¨ ph·∫£i ·ªü nh√† h·ªçc b√†i."</p>
                    <div class="space-y-3 bg-orange-50 p-6 rounded-xl border border-orange-100">
                        <div class="flex items-center gap-2">
                            <span class="font-bold text-orange-600 w-24">N·∫æU:</span>
                            <input type="text" id="q3-if" placeholder="ƒêi·ªÅu ki·ªán l√† g√¨?" class="flex-1 p-2 border rounded focus:ring-2 focus:ring-orange-300 outline-none">
                        </div>
                        <div class="flex items-center gap-2">
                            <span class="font-bold text-green-600 w-24">TH√å:</span>
                            <input type="text" id="q3-then" placeholder="L√†m g√¨ n·∫øu ƒë√∫ng?" class="flex-1 p-2 border rounded focus:ring-2 focus:ring-green-300 outline-none">
                        </div>
                        <div class="flex items-center gap-2">
                            <span class="font-bold text-red-600 w-24">KH√îNG TH√å:</span>
                            <input type="text" id="q3-else" placeholder="L√†m g√¨ n·∫øu sai?" class="flex-1 p-2 border rounded focus:ring-2 focus:ring-red-300 outline-none">
                        </div>
                        <button onclick="checkQ3()" class="mt-4 px-6 py-2 bg-orange-500 text-white rounded-lg shadow hover:bg-orange-600 font-bold w-full md:w-auto">Ki·ªÉm tra ƒê√°p √°n</button>
                        <p id="q3-feedback" class="hidden text-sm font-bold mt-2"></p>
                    </div>
                </div>

            </div>
        </section>

        <!-- SECTION: PRACTICE LAB (CANVAS) -->
        <section id="section-practice" class="hidden space-y-6">
            <div class="bg-white rounded-2xl p-6 shadow-sm border border-gray-100">
                <div class="flex flex-col md:flex-row justify-between items-start md:items-center mb-6">
                    <div>
                        <h2 class="text-2xl font-bold text-gray-800">Ph√≤ng Lab ·∫¢o: M√®o b·∫Øt Chu·ªôt</h2>
                        <p class="text-gray-600">M√¥ ph·ªèng b√†i th·ª±c h√†nh Ti·∫øt 2. ƒêi·ªÅu khi·ªÉn M√®o ch·∫°m v√†o Chu·ªôt ƒë·ªÉ xem m√£ ch·∫°y.</p>
                    </div>
                    <div class="mt-4 md:mt-0 flex gap-2">
                        <button onclick="resetGame()" class="px-4 py-2 bg-gray-200 rounded-lg hover:bg-gray-300 text-sm font-bold">L√†m l·∫°i</button>
                        <button id="btn-run-code" onclick="toggleGameCode()" class="px-4 py-2 bg-green-500 text-white rounded-lg shadow hover:bg-green-600 text-sm font-bold animate-pulse">‚ñ∂ Ch·∫°y M√£ L·ªánh</button>
                    </div>
                </div>

                <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
                    <!-- Game Canvas -->
                    <div class="lg:col-span-2 relative bg-gray-900 rounded-xl overflow-hidden shadow-inner" style="height: 400px;">
                        <canvas id="gameCanvas" width="800" height="400" class="w-full h-full object-contain"></canvas>
                        
                        <!-- Overlay UI -->
                        <div class="absolute bottom-4 left-4 right-4 flex justify-between pointer-events-none">
                            <div class="bg-black bg-opacity-50 text-white px-3 py-1 rounded text-xs">
                                Use Arrow Keys or Touch to Move
                            </div>
                            <div id="game-status" class="bg-black bg-opacity-70 text-green-400 font-mono px-3 py-1 rounded text-xs border border-green-500">
                                Status: Waiting for Code...
                            </div>
                        </div>
                    </div>

                    <!-- Code Block View -->
                    <div class="bg-gray-50 rounded-xl p-4 border border-gray-200 flex flex-col h-full">
                        <h3 class="font-bold text-gray-700 mb-4 flex items-center gap-2">
                            <span class="w-2 h-2 rounded-full bg-red-500" id="code-indicator"></span>
                            K·ªãch b·∫£n (Scratch)
                        </h3>
                        
                        <!-- Visualized Code Blocks -->
                        <div class="space-y-1 opacity-50 transition-opacity duration-300" id="code-visualizer">
                            <div class="scratch-block bg-yellow-400 border-none text-white">Khi b·∫•m v√†o üö©</div>
                            <div class="scratch-block bg-orange-400 ml-0">li√™n t·ª•c</div>
                            <div class="pl-3 border-l-4 border-orange-300 ml-3 space-y-1">
                                <div class="scratch-block bg-blue-500">h∆∞·ªõng v·ªÅ ph√≠a ƒë·ªëi t∆∞·ª£ng mouse-pointer</div>
                                <div class="scratch-block bg-blue-500">di chuy·ªÉn 3 b∆∞·ªõc</div>
                                
                                <!-- The Logic Part -->
                                <div class="scratch-block bg-orange-400 mt-2 transform scale-105 shadow-lg border-2 border-white z-10">
                                    n·∫øu <span class="scratch-hex bg-green-400">ƒëang ch·∫°m Mouse?</span> th√¨
                                </div>
                                <div class="pl-3 border-l-4 border-orange-300 ml-3 py-1">
                                    <div class="scratch-block bg-purple-500">n√≥i "B·∫Øt ƒë∆∞·ª£c r·ªìi!" trong 2 gi√¢y</div>
                                </div>
                            </div>
                        </div>

                        <div class="mt-auto pt-4 border-t border-gray-200">
                            <p class="text-xs text-gray-500 text-center">Nh·∫•n "Ch·∫°y M√£ L·ªánh" ƒë·ªÉ k√≠ch ho·∫°t kh·ªëi l·ªánh "Li√™n t·ª•c" v√† "N·∫øu... th√¨".</p>
                        </div>
                    </div>
                </div>
            </div>
        </section>

    </main>

    <!-- Footer -->
    <footer class="bg-white border-t border-gray-100 mt-auto py-6">
        <div class="max-w-7xl mx-auto px-4 text-center">
            <p class="text-sm text-gray-400">Thi·∫øt k·∫ø cho B√†i 10: C·∫•u tr√∫c R·∫Ω nh√°nh - Tin h·ªçc 5 (Ch√¢n tr·ªùi s√°ng t·∫°o)</p>
        </div>
    </footer>

    <!-- JavaScript Logic -->
    <script>
        // --- Global State ---
        let currentTab = 'overview';
        let matchSelection = { A: null, B: null };
        let matchesFound = 0;
        let score = 0;
        
        // Game State
        let gameRunning = false;
        let cat = { x: 50, y: 200, size: 40, angle: 0 };
        let mouse = { x: 600, y: 200, size: 30 };
        let canvas, ctx;
        let animationId;
        let keys = {};
        let mousePos = { x: 0, y: 0 };

        // --- Initialization ---
        document.addEventListener('DOMContentLoaded', () => {
            initCompetencyChart();
            initGame();
            
            // Touch/Keyboard events for game
            window.addEventListener('keydown', (e) => keys[e.key] = true);
            window.addEventListener('keyup', (e) => keys[e.key] = false);
        });

        // --- Tab Switching ---
        function switchTab(tabId) {
            // Hide all sections
            ['overview', 'theory', 'exercise', 'practice'].forEach(id => {
                document.getElementById(`section-${id}`).classList.add('hidden');
                document.getElementById(`btn-${id}`).classList.remove('active');
            });

            // Show selected
            document.getElementById(`section-${tabId}`).classList.remove('hidden');
            document.getElementById(`btn-${tabId}`).classList.add('active');
            
            // Specific actions
            if (tabId === 'practice' && !gameRunning) {
                drawGame(); // Initial draw
            }
        }

        // --- 1. Competency Chart (Chart.js) ---
        function initCompetencyChart() {
            const ctx = document.getElementById('competencyChart').getContext('2d');
            new Chart(ctx, {
                type: 'radar',
                data: {
                    labels: ['L·∫≠p tr√¨nh (3.4)', 'V·∫•n ƒë·ªÅ K·ªπ thu·∫≠t (5.1)', 'H·ª£p t√°c s·ªë (2.4)', 'B·∫£n quy·ªÅn (3.3)', 'An to√†n (4.1)'],
                    datasets: [{
                        label: 'M·ª©c ƒë·ªô T·∫≠p trung',
                        data: [5, 4, 3, 2, 2], // Emphasize 3.4 and 5.1 based on lesson plan
                        fill: true,
                        backgroundColor: 'rgba(255, 171, 25, 0.2)',
                        borderColor: 'rgb(255, 171, 25)',
                        pointBackgroundColor: 'rgb(255, 171, 25)',
                        pointBorderColor: '#fff',
                        pointHoverBackgroundColor: '#fff',
                        pointHoverBorderColor: 'rgb(255, 171, 25)'
                    }]
                },
                options: {
                    maintainAspectRatio: false,
                    scales: {
                        r: {
                            angleLines: { color: '#eee' },
                            grid: { color: '#eee' },
                            pointLabels: {
                                font: { size: 12, family: 'Nunito' },
                                color: '#666'
                            },
                            suggestedMin: 0,
                            suggestedMax: 5,
                            ticks: { display: false } // Hide numbers for cleaner look
                        }
                    },
                    plugins: {
                        legend: { display: false }
                    }
                }
            });
        }

        // --- 2. Interactive Theory Simulation ---
        function simulateBranch(type, condition) {
            // Reset Styles
            const resetNodes = (prefix) => {
                document.querySelectorAll(`[id^="${prefix}-"]`).forEach(el => {
                    el.classList.remove('active', 'border-green-500', 'border-red-500', 'text-green-600', 'text-red-600');
                    if (el.id.includes('action')) el.style.opacity = '0.5'; 
                });
                document.getElementById(`${prefix}-feedback`).innerText = '';
            };

            if (type === 'missing') {
                resetNodes('m');
                document.getElementById('m-step1').classList.add('active');
                
                setTimeout(() => {
                    document.getElementById('m-decision').classList.add('active');
                    
                    setTimeout(() => {
                        if (condition) {
                            // Rain -> True -> Umbrella
                            document.getElementById('m-action').classList.add('active', 'border-green-500', 'text-green-800');
                            document.getElementById('m-action').style.opacity = '1';
                            document.getElementById('m-feedback').innerText = "Tr·ªùi m∆∞a (ƒê√öNG) -> Th·ª±c hi·ªán: Mang √î!";
                            document.getElementById('m-feedback').className = "text-center mt-4 h-6 font-bold text-green-600";
                        } else {
                            // Sun -> False -> Do nothing
                            document.getElementById('m-feedback').innerText = "Tr·ªùi kh√¥ng m∆∞a (SAI) -> B·ªè qua l·ªánh b√™n trong.";
                            document.getElementById('m-feedback').className = "text-center mt-4 h-6 font-bold text-orange-600";
                        }
                        document.getElementById('m-end').classList.add('active');
                    }, 500);
                }, 500);
            } else {
                resetNodes('f');
                document.getElementById('f-step1').classList.add('active');

                setTimeout(() => {
                    document.getElementById('f-decision').classList.add('active');

                    setTimeout(() => {
                        if (condition) {
                            // Correct
                            document.getElementById('f-action-true').classList.add('active', 'border-green-500', 'text-green-800');
                            document.getElementById('f-action-true').style.opacity = '1';
                            document.getElementById('f-feedback').innerText = "Tr·∫£ l·ªùi ƒë√∫ng -> R·∫Ω sang nh√°nh C·ªòNG ƒêI·ªÇM";
                            document.getElementById('f-feedback').className = "text-center mt-4 h-6 font-bold text-green-600";
                        } else {
                            // Wrong
                            document.getElementById('f-action-false').classList.add('active', 'border-red-500', 'text-red-800');
                            document.getElementById('f-action-false').style.opacity = '1';
                            document.getElementById('f-feedback').innerText = "Tr·∫£ l·ªùi sai -> R·∫Ω sang nh√°nh TR·ª™ ƒêI·ªÇM";
                            document.getElementById('f-feedback').className = "text-center mt-4 h-6 font-bold text-red-600";
                        }
                        document.getElementById('f-end').classList.add('active');
                    }, 500);
                }, 500);
            }
        }

        // --- 3. Interactive Exercise Logic ---
        const correctMatches = {
            1: 1, // Space -> If Then
            2: 2, // Pass/Fail -> If Else
            3: 1, // Edge -> If Then
            4: 2  // Quiz -> If Else
        };

        function selectMatch(col, id) {
            // Visual selection
            document.querySelectorAll(`#match-col-${col.toLowerCase()} button`).forEach(b => b.classList.remove('bg-orange-100', 'border-orange-500'));
            document.getElementById(`match-${col}${id}`).classList.add('bg-orange-100', 'border-orange-500');
            
            matchSelection[col] = id;

            // Check if both selected
            if (matchSelection.A && matchSelection.B) {
                checkMatch();
            }
        }

        function checkMatch() {
            const feedback = document.getElementById('match-feedback');
            const isCorrect = correctMatches[matchSelection.A] === matchSelection.B;

            if (isCorrect) {
                feedback.innerHTML = `<span class="text-green-600">Ch√≠nh x√°c! C·∫∑p ${matchSelection.A}-${matchSelection.B} ƒë√∫ng.</span>`;
                // Disable clicked buttons to show completion
                document.getElementById(`match-A${matchSelection.A}`).classList.add('opacity-50', 'cursor-not-allowed');
                document.getElementById(`match-A${matchSelection.A}`).onclick = null;
                // Reset selection
                matchSelection = { A: null, B: null };
                updateScore(10);
            } else {
                feedback.innerHTML = `<span class="text-red-500">Sai r·ªìi! H√£y th·ª≠ l·∫°i.</span>`;
                // Reset visual
                setTimeout(() => {
                    document.querySelectorAll('.bg-orange-100').forEach(el => el.classList.remove('bg-orange-100', 'border-orange-500'));
                    matchSelection = { A: null, B: null };
                }, 1000);
            }
        }

        function checkQ2() {
            const s1 = document.getElementById('q2-select1').value;
            const s2 = document.getElementById('q2-select2').value;
            
            if (s1 === 'correct' && s2 === 'correct') {
                updateScore(30); // Big points for identifying both
                alert("Tuy·ªát v·ªùi! Em ƒë√£ nh·∫≠n di·ªán ƒë√∫ng c·∫£ 2 kh·ªëi l·ªánh.");
                document.getElementById('q2-select1').disabled = true;
                document.getElementById('q2-select2').disabled = true;
            }
        }

        function checkQ3() {
            const i = document.getElementById('q3-if').value.toLowerCase();
            const t = document.getElementById('q3-then').value.toLowerCase();
            const e = document.getElementById('q3-else').value.toLowerCase();
            const fb = document.getElementById('q3-feedback');

            let points = 0;
            // Flexible keyword checking
            if (i.includes('b√†i t·∫≠p') || i.includes('xong')) points += 10;
            if (t.includes('xem phim')) points += 10;
            if (e.includes('h·ªçc b√†i') || e.includes('·ªü nh√†')) points += 10;

            fb.classList.remove('hidden');
            if (points === 30) {
                fb.innerText = "Ho√†n h·∫£o! Em ƒë√£ d·ªãch ƒë√∫ng √Ω c·ªßa m·∫π sang ng√¥n ng·ªØ m√°y t√≠nh.";
                fb.className = "text-sm font-bold mt-2 text-green-600";
                updateScore(30);
            } else if (points > 0) {
                fb.innerText = "Kh√° t·ªët, nh∆∞ng h√£y ki·ªÉm tra l·∫°i t·ª´ng ph·∫ßn nh√©.";
                fb.className = "text-sm font-bold mt-2 text-orange-600";
            } else {
                fb.innerText = "H√£y ƒë·ªçc k·ªπ l·∫°i c√¢u d·∫∑n c·ªßa m·∫π nh√©.";
                fb.className = "text-sm font-bold mt-2 text-red-600";
            }
        }

        function updateScore(points) {
            score += points;
            // Cap at 100
            if (score > 100) score = 100;
            document.getElementById('score-display').innerText = `${score}/100`;
        }

        // --- 4. Canvas Game Simulation (Lab Ti·∫øt 2) ---
        function initGame() {
            canvas = document.getElementById('gameCanvas');
            ctx = canvas.getContext('2d');
            
            // Mouse tracking for "touching mouse-pointer" logic
            canvas.addEventListener('mousemove', (e) => {
                const rect = canvas.getBoundingClientRect();
                mousePos.x = (e.clientX - rect.left) * (canvas.width / rect.width);
                mousePos.y = (e.clientY - rect.top) * (canvas.height / rect.height);
                
                // Update 'Mouse' object to follow cursor for interaction
                mouse.x = mousePos.x;
                mouse.y = mousePos.y;
            });

            // Mobile touch support
            canvas.addEventListener('touchmove', (e) => {
                e.preventDefault();
                const rect = canvas.getBoundingClientRect();
                const touch = e.touches[0];
                mousePos.x = (touch.clientX - rect.left) * (canvas.width / rect.width);
                mousePos.y = (touch.clientY - rect.top) * (canvas.height / rect.height);
                mouse.x = mousePos.x;
                mouse.y = mousePos.y;
            }, { passive: false });
        }

        function toggleGameCode() {
            const btn = document.getElementById('btn-run-code');
            const indicator = document.getElementById('code-indicator');
            const visualizer = document.getElementById('code-visualizer');
            const status = document.getElementById('game-status');

            gameRunning = !gameRunning;

            if (gameRunning) {
                btn.innerText = "‚èπ D·ª´ng M√£ L·ªánh";
                btn.classList.remove('bg-green-500', 'hover:bg-green-600', 'animate-pulse');
                btn.classList.add('bg-red-500', 'hover:bg-red-600');
                indicator.classList.remove('bg-red-500');
                indicator.classList.add('bg-green-500', 'animate-ping');
                visualizer.classList.remove('opacity-50');
                status.innerText = "Status: Running (Loop active)";
                status.classList.remove('text-green-400');
                status.classList.add('text-white');
                animateGame();
            } else {
                btn.innerText = "‚ñ∂ Ch·∫°y M√£ L·ªánh";
                btn.classList.add('bg-green-500', 'hover:bg-green-600', 'animate-pulse');
                btn.classList.remove('bg-red-500', 'hover:bg-red-600');
                indicator.classList.add('bg-red-500');
                indicator.classList.remove('bg-green-500', 'animate-ping');
                visualizer.classList.add('opacity-50');
                status.innerText = "Status: Code Stopped";
                cancelAnimationFrame(animationId);
            }
        }

        function resetGame() {
            cat.x = 50;
            cat.y = 200;
            cat.angle = 0;
            drawGame();
        }

        function animateGame() {
            if (!gameRunning) return;
            
            // Logic: Move towards mouse
            const dx = mouse.x - cat.x;
            const dy = mouse.y - cat.y;
            const dist = Math.sqrt(dx*dx + dy*dy);
            
            if (dist > 5) {
                cat.x += (dx / dist) * 2; // Move speed 2
                cat.y += (dy / dist) * 2;
                cat.angle = Math.atan2(dy, dx);
            }

            // Logic: Branching check (Touching Mouse?)
            // Simple circle collision
            const collision = dist < (cat.size/2 + mouse.size/2);

            drawGame(collision);

            animationId = requestAnimationFrame(animateGame);
        }

        function drawGame(isSpeaking = false) {
            // Clear
            ctx.fillStyle = "#1a202c"; // Dark bg
            ctx.fillRect(0, 0, canvas.width, canvas.height);

            // Draw Mouse (Goal)
            ctx.fillStyle = "#9ca3af";
            ctx.beginPath();
            ctx.arc(mouse.x, mouse.y, mouse.size/2, 0, Math.PI * 2);
            ctx.fill();
            ctx.fillStyle = "white";
            ctx.font = "12px Nunito";
            ctx.fillText("Mouse", mouse.x - 15, mouse.y - 20);

            // Draw Cat (Player)
            ctx.save();
            ctx.translate(cat.x, cat.y);
            // Simple Cat Shape
            ctx.fillStyle = "#FFAB19"; // Orange Cat
            ctx.beginPath();
            ctx.arc(0, 0, cat.size/2, 0, Math.PI * 2);
            ctx.fill();
            // Eyes
            ctx.fillStyle = "black";
            ctx.beginPath();
            ctx.arc(-8, -5, 4, 0, Math.PI * 2);
            ctx.arc(8, -5, 4, 0, Math.PI * 2);
            ctx.fill();
            
            // Speech Bubble if "Touching"
            if (isSpeaking) {
                ctx.fillStyle = "white";
                ctx.beginPath();
                ctx.roundRect(20, -50, 120, 40, 10);
                ctx.fill();
                ctx.beginPath();
                ctx.moveTo(20, -20);
                ctx.lineTo(10, -10);
                ctx.lineTo(30, -20);
                ctx.fill();
                
                ctx.fillStyle = "black";
                ctx.font = "bold 14px Nunito";
                ctx.fillText("B·∫Øt ƒë∆∞·ª£c r·ªìi!", 30, -25);
                
                // Visual feedback in status
                document.getElementById('game-status').innerText = "Status: CONDITION TRUE -> Action Executed";
                document.getElementById('game-status').classList.add('text-green-400');
            } else {
                if (gameRunning) {
                    document.getElementById('game-status').innerText = "Status: Condition False (Moving...)";
                    document.getElementById('game-status').classList.remove('text-green-400');
                }
            }

            ctx.restore();
        }

    </script>
</body>

</html>
